---
title: 일반결제 연동 유의사항
description: (신)나이스페이먼츠 일반결제 연동 유의사항을 소개합니다.
---

import Details from "~/components/gitbook/Details.astro";
import Figure from "~/components/gitbook/Figure.astro";

## 공통

### 1. 결제창 호출 실패 시 정확한 사유를 알 수 없습니다.

(신) 나이스페이먼츠의 경우 pg 설정 정보 및 파라미터 설정 오류와 같은 이유로 결제창 호출이 불가능한 경우 “알 수 없는 이유로 결제가 중단되었습니다. 나이스페이로 문의(1661-0808)하세요.” 에러를 리턴합니다. 에러 메세지가 지속적으로 노출되는 경우 결제창 호출 시 사용한 파라미터 전문과 함께 포트원으로 문의바랍니다.

### 2. 주문번호(merchant_uid) 재사용이 불가능할 수 있습니다.

나이스페이먼츠 상점아이디에 주문번호 중복방지가 활성화되어있는 경우 동일한 주문번호의 거래 및 취소를 하루동안 방지합니다. 고객사에서 하루 동안 이중 결제 요청 및 이중 취소 요청 등을 방지하기 위해 사용됩니다. 만약, 해당 기능을 비활성화하고 싶으신 경우 나이스페이먼츠에 문의하시기 바랍니다.

### 3. 주문번호(merchant_uid)에 한글 및 특수문자 사용이 불가능합니다.

주문번호 채번 시 영문 및 숫자를 조합하여 사용해야합니다. 한글 및 특수문자가 포함되는 경우 결제가 정상적으로 이루어지지 않을 수 있습니다.

## 카드 결제

| 기능                                  | 사용 가능 여부                                            |
| ------------------------------------- | --------------------------------------------------------- |
| 상점 부담 무이자 할부                 | 가능                                                      |
| 다이렉트 호출                         | <font color="red"> **단독 사용 불가능** </font> (고정 할부 개월수가 함께 전달 되어야 함) |
| 다이렉트 호출 + 고정 할부 개월수      | 가능                                                      |
| 다이렉트 호출 + 리스트 할부 개월수    | <font color="red"> **불가능** </font>                                                  |
| 비 다이렉트 호출 + 고정 할부 개월수   | **PC만 가능**                                               |
| 비 다이렉트 호출 + 리스트 할부 개월수 | **PC만 가능**                                               |

### 1. 토스뱅크 카드사 다이렉트 호출을 지원하지 않습니다.

(신) 나이스페이먼츠의 경우 토스뱅크 카드(card.direct.code = "092") 다이렉트 호출이 불가능합니다.

### 2. 카드사 다이렉트 호출 시 고정 할부 개월수를 필수 입력해야 합니다.

(신) 나이스페이먼츠는 **카드사 다이렉트 호출시 고정 할부 개월수를 <font color="red"> 필수 </font>로 입력**해야 합니다. 결제 금액이 할부 지원 금액 미만(일반적으로 50,000원이상 결제 시 할부 기능을 지원하나 카드사에 따라 다를 수 있습니다.)인 경우 **할부 개월수를 0(일시불)으로 전달**해야 합니다.

<Details>
<p slot="summary">BC카드 다이렉트 호출 + 5개월 고정 할부</p>

```javascript
IMP.request_pay(
  {
    // ...중략
    pg: "nice_v2",
    pay_method: "card",
    card: {
      direct: {
        // 다이렉트 호출할 카드사 코드와 고정 할부 개월수를 모두 지정해야 함
        code: "361", // BC카드
        quota: 5, // 5개월 할부
      },
    },
  },
  콜백함수
);
```

</Details>

<Details>
<p slot="summary">삼성카드 다이렉트 호출 + 일시불</p>

```javascript
IMP.request_pay(
  {
    // ...중략
    pg: "nice_v2",
    pay_method: "card",
    card: {
      direct: {
        // 다이렉트 호출 할 카드사 코드와 고정 할부 개월수를 모두 지정해야 함
        code: "365", // 삼성카드
        quota: 0, // 일시불
      },
    },
  },
  콜백함수
);
```

</Details>

### 3. 모바일 환경에서는 다이렉트 호출시에만 할부 옵션 설정이 가능합니다.

(신) 나이스페이먼츠의 경우 일반 카드 결제 시(간편결제 제외) 할부 옵션(고정 할부 개월수)사용이 가능하나 **모바일 환경**에서는 **카드사 다이렉트 호출할 때만 할부 옵션 사용이 가능합니다.** 만약 모바일 환경에서 다이렉트 호출 코드 없이 할부 옵션을 전달하는 경우 무시됩니다.

<Details>
<p slot="summary">모바일 환경에서 리스트 할부 개월수만 전달 → 전달한 파라미터가 무시되고 모든 할부 개월수 렌더링</p>

```javascript
IMP.request_pay(
  {
    // ...중략
    pg: "nice_v2",
    pay_method: "card",
    display: { card_quota: [2, 3, 4, 5, 6] }, // 2 ~ 6 개월 리스트 할부 개월수 적용 시도
  },
  콜백함수
);
```

import screenshot1 from "./_assets/caution/only-list-installment-on-mobile.png";

<Figure src={screenshot1} />

</Details>

<Details>
<p slot="summary">모바일 환경에서 3개월 고정 할부 개월수만 전달 → 전달한 파라미터가 무시되고 모든 할부 개월수 렌더링</p>

```javascript
// ...중략
IMP.request_pay(
  {
    pg: "nice_v2",
    pay_method: "card",
    display: { card_quota: [3] }, // 3개월 고정 할부 개월수 적용 시도
  },
  콜백함수
);
```

<Figure src={screenshot1} />

</Details>

## 가상계좌 결제

### 1. 가상계좌 입금 기한(`vbank_due`) 필수 입력해야 합니다.

(신) 나이스페이먼츠 가상 계좌 발급 시, 입금 기한은 필수 입력해야 하며 아래 4가지 형식만 유효합니다. 입금 기한을 입력하지 않거나, 유효하지 않은 형식을 입력할 경우 가상계좌 발급 결제창이 호출되지 않고 "결제 창 호출에 실패하였습니다. 나이스페이 V2 가상계좌 발급시 유효한 입금 기한을 필수로 입력해야 합니다." 라는 에러 메세지가 리턴되오니 유의하시기 바랍니다.

- YYYY-MM-DD HH:mm:ss
- YYYYMMDDHHmmss
- YYYY-MM-DD
- YYYYMMDD

## 계좌이체 결제

### 1. 계좌이체 다이렉트 호출 시 은행 코드 지정이 불가능합니다.

(신) 나이페이먼츠 계좌이체 다이렉트 호출 시 뱅크페이 창이 다이렉트로 호출됩니다.

### 2. 계좌이체 다이렉트 호출 시 현금영수증 정보 필수 입력 해야합니다.

계좌이체 거래는 계좌에서 현금성 결제로 현금영수증 발급이 가능하므로 현금영수증 정보를 필수로 입력해야 합니다. 만약 입력하지 않을 경우 (신) 나이스페이먼츠 계좌이체 다이렉트 호출 시 **현금영수증 발급 유형은 필수 입력**입니다.라는 에러 메시지가 리턴되면서 결제창이 호출되지 않으니 유의하시기 바랍니다.

### 3. 계좌이체 에스크로 결제 시 다이렉트 호출을 지원하지 않습니다.

나이스페이먼츠 정책상 에스크로가 설정된 계좌이체 방식으로 결제를 진행하는 경우 다이렉트 호출이 불가능합니다. 아래와 같이 계좌이체, 에스크로, 다이렉트를 호출하고자 파라미터를 설정할 경우 "나이스페이 V2 계좌이체 에스크로 결제시 다이렉트 호출은 불가능합니다."라는 에러 메시지가 리턴되면서 결제창이 호출되지 않으니 유의하시기 바랍니다.

### 4. 계좌이체 에스크로 결제 시 결제창에 유효한 이메일을 입력해야 합니다.

유효하지 않는 이메일을 입력하는 경우 **이메일 주소 오류**라는 에러 메시지와 함께 결제 실패합니다. 또한 실제로 유효한 이메일 도메인이더라도 나이스페이먼츠 정책상 유효하지 않다고 판단하는 이메일 주소(예) .finance로 끝나는 이메일 주소)를 입력한 경우 정상 승인되지만 **API로 에스크로 정보 등록 시 에스크로 구매 확정 이메일을 수신할 수 없습니다.**

<Details>
<p slot="summary">자세히 보기</p>

```javascript
IMP.request_pay(
  {
    // ...중략
    pg: "nice_v2",
    pay_method: "trans", // 계좌이체 결제
    escrow: true, // 에스크로 결제
  },
  콜백함수
);
```

import screenshot2 from "./_assets/caution/escrow-trans.png";

<Figure src={screenshot2} />

</Details>

## 휴대폰 소액결제

### 1. 실물/컨텐츠 여부(`digital`) 필수 입력해야 합니다.

휴대폰 소액결제시 실물/컨텐츠 여부(digital) 파라미터는 필수 입력입니다. 입력하지 않는 경우 "나이스페이 V2 휴대폰 소액결제시 상품 유형 파라미터는 필수 입력입니다." 라는 에러 메시지가 뜨면서 결제창이 호출되지 않으니 유의하시기 바랍니다.

| digital | 의미   |
| ------- | ------ |
| true    | 컨텐츠 |
| false   | 실물   |

또한 상점 아이디 설정과 실물/컨텐츠 여부가 불일치할 경우 "CPID 설정 오류"라는 메시지가 리턴되며 결제창 호출에 실패하니 유의하시기 바랍니다.

## 상품권 결제

### 1. 컬쳐랜드(`cultureland`)만 지원하고 있습니다.

(신) 나이스페이먼츠는 상품권 결제시 컬쳐랜드만 지원하며 북앤라이프, 스마트문상, 해피머니 등은 지원하지 않습니다.

### 2. MallUserID(`bypass.nice_v2.MallUserID`)는 필수 입력해야 합니다.

(신) 나이스페이먼츠 상품권 결제시 가맹점 구매자 ID를 의미하는 MalluserID는 필수 입력이며, bypass 파라미터로 전달할 수 있습니다.

### 3. 승인 완료시 승인번호(`apply_num`)정보를 전달하지 않습니다.

(신) 나이스페이먼츠의 경우 상품권 결제시에는 승인 번호 확인이 어렵습니다. 따라서 결제 내역 조회시 승인 번호는 null로 리턴됩니다.

<Details>
<p slot="summary">결제내역 조회 API 호출 결과</p>

```javascript
// GET /payments/{imp_uid}
{
  // ...중략
  status: "paid",
  pay_method: "cultureland",
  pg: "nice_v2",
  apply_num: null,
}
```

</Details>

## 카카오페이 (간편결제 허브형) 

| 기능                                  | 사용 가능 여부                                                         |
| ------------------------------------- | ---------------------------------------------------------------------- |
| 상점 부담 무이자 할부                 | <font color="red"> **불가능** </font>                                                               |
| 다이렉트 호출                         | BC, 국민, 삼성, 신한, 현대, 롯데, 씨티, NH농협 그리고 하나 카드만 가능 |
| 다이렉트 호출 + 고정 할부 개월수      | BC, 국민, 삼성, 신한, 현대, 롯데, 씨티, NH농협 그리고 하나 카드만 가능 |
| 다이렉트 호출 + 리스트 할부 개월수    | <font color="red"> **불가능** </font>                                                                 |
| 비 다이렉트 호출 + 고정 할부 개월수   | <font color="red"> **단독 사용 불가능** </font> (다이렉트 호출 할 카드사 코드를 함께 전달해야 함)    |
| 비 다이렉트 호출 + 리스트 할부 개월수 | <font color="red"> **불가능** </font>                                                             |

## 네이버페이 (간편결제 허브형) 

| 기능                                  | 사용 가능 여부                                                         |
| ------------------------------------- | ---------------------------------------------------------------------- |
| 상점 부담 무이자 할부                 | <font color="red"> **불가능** </font>                                                                |
| 다이렉트 호출                         | BC, 국민, 삼성, 신한, 현대, 롯데, 씨티, NH농협 그리고 하나 카드만 가능 |
| 다이렉트 호출 + 고정 할부 개월수      | BC, 국민, 삼성, 신한, 현대, 롯데, 씨티, NH농협 그리고 하나 카드만 가능 |
| 다이렉트 호출 + 리스트 할부 개월수    | 가능(단, **일시불이 항상 포함** 됨)                                      |
| 비 다이렉트 호출 + 고정 할부 개월수   | <font color="red"> **단독 사용 불가능** </font> (다이렉트 호출 할 카드사 코드를 함께 전달해야 함)    |
| 비 다이렉트 호출 + 리스트 할부 개월수 | 가능(단, **일시불이 항상 포함** 됨)                                      |

### 1. 결제 수단을 카드(`naverpay_point`) 또는 포인트(`naverpay_card`)로 지정해야 합니다.

(신) 나이스페이먼츠를 통한 네이버페이 결제 시 카드 또는 포인트 결제를 지정하여 호출해야합니다. 결제 수단(`pay_method`) 파라미터에 `naverpay`가 아닌 `naverpay_card` 또는 `naverpay_point` 둘 중 하나로 입력해야 정상적으로 결제창이 호출되오니 유의하시기 바랍니다.

### 2. 네이버페이 머니와 포인트 복합 결제 시 포인트가 먼저 사용 됩니다.

네이버페이 포인트 결제 시 네이버페이 머니, 포인트 또는 복합(머니와 포인트 함께 사용) 방식으로 결제가 가능하며 만약 복합 방식으로 결제할 경우 포인트 금액이 먼저 차감됩니다.

### 3. 네이버페이 포인트 결제 시 현금영수증 정보를 필수 입력해야 합니다.

네이버페이 포인트 결제 시 현금영수증 발급이 가능하며 **현금영수증 정보를 필수로 입력**해야 합니다. 만약 입력하지 않을 경우 "나이스페이 V2 네이버페이 포인트 결제시 현금영수증 발급 유형은 필수 입력입니다."라는 에러가 리턴되면서 결제창이 호출되지 않으니 유의하시기 바랍니다. 단, **네이버페이 머니로 결제할 경우에만 현금영수증이 발급**됩니다. 결제 금액 모두 네이버페이 포인트로 결제하는 경우에는 결제창 호출 시 현금영수증 정보를 전달하더라도 발급되지 않습니다.

## 페이코 (간편결제 허브형) 

| 기능                                  | 사용 가능 여부 |
| ------------------------------------- | -------------- |
| 상점 부담 무이자 할부                 | 가능           |
| 다이렉트 호출                         | 가능           |
| 다이렉트 호출 + 고정 할부 개월수      | 가능           |
| 다이렉트 호출 + 리스트 할부 개월수    | 가능           |
| 비 다이렉트 호출 + 고정 할부 개월수   | <font color="red"> **불가능** </font>        |
| 비 다이렉트 호출 + 리스트 할부 개월수 | 가능           |

## 애플페이/LPAY (간편결제 허브형) 

| 기능                                  | 사용 가능 여부 |
| ------------------------------------- | -------------- |
| 상점 부담 무이자 할부                 | <font color="red"> **불가능** </font>         |
| 다이렉트 호출                         | <font color="red"> **불가능** </font>         |
| 다이렉트 호출 + 고정 할부 개월수      | <font color="red"> **불가능** </font>         |
| 다이렉트 호출 + 리스트 할부 개월수    | <font color="red"> **불가능** </font>         |
| 비 다이렉트 호출 + 고정 할부 개월수   | <font color="red"> **불가능** </font>        |
| 비 다이렉트 호출 + 리스트 할부 개월수 | <font color="red"> **불가능** </font>        |

## 삼성페이/11PAY/SSGPAY (간편결제 허브형) 

| 기능                                  | 사용 가능 여부 |
| ------------------------------------- | -------------- |
| 상점 부담 무이자 할부                 | 가능           |
| 다이렉트 호출                         | <font color="red"> **불가능** </font>         |
| 다이렉트 호출 + 고정 할부 개월수      | <font color="red"> **불가능** </font>         |
| 다이렉트 호출 + 리스트 할부 개월수    | <font color="red"> **불가능** </font>         |
| 비 다이렉트 호출 + 고정 할부 개월수   | <font color="red"> **불가능** </font>         |
| 비 다이렉트 호출 + 리스트 할부 개월수 | <font color="red"> **불가능** </font>         |

## SSGPAY

### 1. SSGPAY 은행 계좌 결제 시 주문 번호에 특수 문자를 사용할 수 없습니다.

SSGPAY 정책상 은행 계좌 결제시에는 **주문 번호(`merchant_uid`)에 특수 문자가 허용되지 않습니다.** 주문 번호에 특수문자 입력 시 "나이스페이 V2 SSGPAY 은행 계좌 결제시 주문 번호에 특수문자는 허용되지 않습니다."와 같은 에러 메시지가 리턴되면서 결제창이 호출되지 않으니 참고 부탁드립니다.

### 2. SSGPAY 은행 계좌 결제 시 현금영수증 정보를 필수 입력해야합니다.

SSGPAY 은행 계좌 거래는 현금영수증 발급이 가능하며, **현금영수증 정보를 필수 입력** 해야합니다. 만약 입력하지 않을 경우 "나이스페이 V2 SSGPAY 은행 계좌 결제시 현금영수증 발급 유형은 필수 입력입니다."라는 에러 메시지가 리턴되면서 결제창이 호출되지 않으니 유의하시기 바랍니다.

<Details>
<p slot="summary">파라미터 예시</p>

```javascript
IMP.request_pay({
  // ...중략
  pg: "nice_v2",
  pay_method: "ssgpay_bank",
  bypass: {
    cashReceiptType: "corporate", // 현금영수증 발급 유형(corporate: 지출증빙, personal: 소득공제)
    customerIdentifier: "1178178260", // 현금영수증 발행 식별 정보(사업자 등록번호 또는 휴대폰 번호)
  },
});
```

</Details>

### 3. SSGPAY 은행 계좌 결제 시 현금영수증 발급 정보를 확인할 수 없습니다.

SSGPAY 은행 계좌 결제 시 현금영수증 발급 정보를 입력하여 정상적으로 발급되더라도 승인 완료(status: paid)후 현금영수증 발급 정보 확인이 어려워 포트원 API로 결제/현금영수증 발급 내역 조회 또는 포트원 콘솔에서 현금영수증 내역을 확인이 불가능합니다. 해당 결제의 현금영수증 발급 정보를 확인하고싶은 경우 나이스페이먼츠 어드민에서 확인이 가능합니다.
[→ 나이스페이먼츠 어드민 바로가기](https://npg.nicepay.co.kr/logIn.do)

<Details>
<p slot="summary">결제내역 조회 API 호출 결과</p>

```javascript
// GET /payments/{imp_uid}

{
  // ...중략
  pay_method: "trans",
  emb_pg_provider: "ssgpay",
  pg: "nice_v2",
  status: "paid",
  cash_receipt_issued: false, // 실제로는 현금영수증이 발급됐으나 포트원에 정보가 없으므로 false로 내려감
}
```

</Details>

<Details>
<p slot="summary">현금영수증 발급 내역 조회 API 호출 결과</p>

```javascript
// GET /receipts/{imp_uid}

{
  code: -1,
  message:
    "해당 아임포트 고유 번호({아임포트 번호})로 현금영수증을 발급 한 내역이 존재하지 않습니다.",
  data: null,
}
```

</Details>

## 알리페이

### 1. 

## 현금영수증

### 1. 소득공제 현금영수증 발급 시 휴대폰 정보로만 발급이 가능합니다.

(신) 나이스페이먼츠의 경우 현금영수증 발급 유형(`cashReceiptType`)을 소득 공제(`personal`)로 지정한 경우, 현금영수증 발급 정보(`customerIdentifier`)는 휴대폰 번호만 가능하며 주민등록번호 입력시 "현금영수증 식별 번호가 올바르지 않습니다."라는 에러 메시지가 리턴되면서 결제창이 호출되지 않으니 유의하시기 바랍니다.

<Details>
<p slot="summary">파라미터 예시</p>

```javascript
IMP.request_pay(
  {
    // ...중략
    pg: "nice_v2",
    pay_method: "naverpay_point", // 네이버페이 포인트 결제
    bypass: {
      cashReceiptType: "personal", // 소득공제
      customerIdentifier: "01012345678", // 핸드폰 번호 입력(주민등록번호 불가능)
    },
  },
  콜백함수
);
```

</Details>

### 2. 통합결제창을 이용한 계좌이체, 가상계좌 발급 시 현금영수증 정보를 직접 입력해야 합니다. 

결제대행사의 통합결제창 내에서 계좌이체 또는 가상계좌 발급 시 구매자가 결제창에 직접 현금영수증 정보를 입력해야 정상 발급됩니다.
